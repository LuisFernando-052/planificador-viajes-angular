<div class="form-container animate-fade-in">
  <div class="form-header">
    <h2 class="form-title">{{ isEditMode ? 'Editar Actividad' : 'Nueva Actividad' }}</h2>
    <button type="button" class="btn btn-secondary" (click)="volver()">‚Üê Volver al Viaje</button>
  </div>

  <form [formGroup]="actividadForm" (ngSubmit)="onSubmit()">
    
    <!-- Nombre -->
    <div class="form-group">
      <label for="nombre" class="form-label required">Nombre de la Actividad</label>
      <input 
        type="text" 
        id="nombre" 
        formControlName="nombre"
        class="form-control"
        [class.is-invalid]="nombre?.invalid && nombre?.touched"
        [class.is-valid]="nombre?.valid && nombre?.touched"
        placeholder="Ej: Visita a la Torre Eiffel"
      >
      <span class="form-error" *ngIf="nombre?.invalid && nombre?.touched">
        <small *ngIf="nombre?.errors?.['required']">El nombre es obligatorio</small>
        <small *ngIf="nombre?.errors?.['minlength']">M√≠nimo 3 caracteres</small>
      </span>
    </div>

    <!-- Descripci√≥n -->
    <div class="form-group">
      <label for="descripcion" class="form-label required">Descripci√≥n</label>
      <textarea 
        id="descripcion" 
        formControlName="descripcion"
        class="form-control"
        [class.is-invalid]="descripcion?.invalid && descripcion?.touched"
        [class.is-valid]="descripcion?.valid && descripcion?.touched"
        placeholder="Describe la actividad..."
        rows="3"
      ></textarea>
      <span class="form-error" *ngIf="descripcion?.invalid && descripcion?.touched">
        <small *ngIf="descripcion?.errors?.['required']">La descripci√≥n es obligatoria</small>
        <small *ngIf="descripcion?.errors?.['minlength']">M√≠nimo 5 caracteres</small>
      </span>
    </div>

    <!-- Categor√≠a -->
    <div class="form-group">
      <label class="form-label required">Categor√≠a</label>
      <div class="categoria-grid">
        <label 
          *ngFor="let cat of categorias" 
          class="categoria-option"
          [class.selected]="categoria?.value === cat.value"
        >
          <input 
            type="radio" 
            [value]="cat.value" 
            formControlName="categoria"
            class="radio-input"
          >
          <span class="categoria-icon">{{ cat.icon }}</span>
          <span class="categoria-label">{{ cat.label }}</span>
        </label>
      </div>
    </div>

    <!-- Fecha y Hora -->
    <div class="row">
      <div class="col-6">
        <div class="form-group">
          <label for="fecha" class="form-label required">Fecha</label>
          <input 
            type="date" 
            id="fecha" 
            formControlName="fecha"
            class="form-control"
            [class.is-invalid]="fecha?.invalid && fecha?.touched"
            [class.is-valid]="fecha?.valid && fecha?.touched"
          >
          <span class="form-error" *ngIf="fecha?.invalid && fecha?.touched">
            <small *ngIf="fecha?.errors?.['required']">La fecha es obligatoria</small>
          </span>
        </div>
      </div>

      <div class="col-6">
        <div class="form-group">
          <label class="form-label required">Hora</label>
          <div class="time-input-group">
            <select 
              formControlName="horaNumero"
              class="form-control time-select"
              [class.is-invalid]="horaNumero?.invalid && horaNumero?.touched"
            >
              <option value="" disabled>HH</option>
              <option value="01">01</option>
              <option value="02">02</option>
              <option value="03">03</option>
              <option value="04">04</option>
              <option value="05">05</option>
              <option value="06">06</option>
              <option value="07">07</option>
              <option value="08">08</option>
              <option value="09">09</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
            </select>
            
            <span class="time-separator">:</span>
            
            <select 
              formControlName="minutos"
              class="form-control time-select"
              [class.is-invalid]="minutos?.invalid && minutos?.touched"
            >
              <option value="" disabled>MM</option>
              <option value="00">00</option>
              <option value="15">15</option>
              <option value="30">30</option>
              <option value="45">45</option>
            </select>
            
            <select 
              formControlName="periodo"
              class="form-control period-select"
              [class.is-invalid]="periodo?.invalid && periodo?.touched"
            >
              <option value="" disabled>--</option>
              <option value="AM">AM</option>
              <option value="PM">PM</option>
            </select>
          </div>
          <span class="form-error" *ngIf="(horaNumero?.invalid || minutos?.invalid || periodo?.invalid) && (horaNumero?.touched || minutos?.touched || periodo?.touched)">
            <small>La hora completa es obligatoria</small>
          </span>
          <span class="form-hint">üïê Ejemplo: 02:30 PM</span>
        </div>
      </div>
    </div>

    
    <!-- Costo -->
    <div class="form-group">
      <label for="costo" class="form-label required">Costo ($)</label>
      <input 
        type="number" 
        id="costo" 
        formControlName="costo"
        class="form-control"
        [class.is-invalid]="costo?.invalid && costo?.touched"
        [class.is-valid]="costo?.valid && costo?.touched"
        placeholder="0.00"
        min="0"
        step="0.01"
      >
      <span class="form-error" *ngIf="costo?.invalid && costo?.touched">
        <small *ngIf="costo?.errors?.['required']">El costo es obligatorio</small>
        <small *ngIf="costo?.errors?.['min']">Debe ser mayor o igual a 0</small>
      </span>
    </div>

    <!-- Mensajes -->
    <div class="alert alert-danger" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>

    <div class="alert alert-success" *ngIf="successMessage">
      {{ successMessage }}
    </div>

    <!-- Botones -->
    <div class="form-actions">
      <button 
        type="button" 
        class="btn btn-secondary"
        (click)="volver()"
        [disabled]="isLoading"
      >
        Cancelar
      </button>
      <button 
        type="submit" 
        class="btn btn-primary"
        [disabled]="isLoading || actividadForm.invalid"
      >
        <span *ngIf="!isLoading">{{ isEditMode ? 'üíæ Actualizar' : '‚ú® Crear Actividad' }}</span>
        <span *ngIf="isLoading">‚è≥ Guardando...</span>
      </button>
    </div>
  </form>
</div>